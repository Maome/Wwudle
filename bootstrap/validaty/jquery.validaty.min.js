/*!
 * jQuery Validaty - A Validation Plugin
 *
 * Licensed under The MIT License
 *
 * @version        0.3.0
 * @author         Washington Botelho
 * @documentation  wbotelhos.com/validaty
 *
 */

;(function(c){var a={init:function(d){return this.each(function(){a.destroy.call(this);this.opt=c.extend({},c.fn.validaty.defaults,d);var e=c(this).addClass("validaty");a._bind.call(this);e.data({settings:this.opt,validaty:true});});},_bind:function(){var d=this,g=c(this);d.inputs=a._fields.call(d);d.distinct=a._distinct.call(d);g.on("submit.validaty",function(i){a._process.call(d,d.distinct,i);});for(var e=0;e<d.inputs.length;e++){var h=d.inputs[e],j=b.getParams(h).actions;a._setHash.call(d,h);h=c(h);for(index in j){var f=j[index].args.join(".validaty ")+".validaty";h.on(f,function(i,k){if(!k){a._process.call(d,[this],i);}});}}},_balloon:function(d){var g=d.el.offset(),f="<ul></ul>",e={id:d.el[0].hash,"class":"validaty-message"};if(this.opt.balloon){f+="<div></div>";e["class"]="validaty-balloon";e.css={top:g.top,left:g.left+d.el.outerWidth()-15};}e.html=f;return c("<div />",e).insertAfter(d.el[0]);},_clear:function(d){c("#"+d.hash).remove();c(d).removeClass("invalid valid");},_display:function(d){var e=a._balloon.call(this,d);a._writeBalloon.call(this,e,d);a._showBalloon.call(this,e);},_distinct:function(){var f=[],e=[],d=this.opt.balloon?this.inputs:c(c(this.inputs).get().reverse());d.each(function(){if(b.isCheckable(this)){if(c.inArray(this.name,f)===-1){f.push(this.name);e.push(this);}}else{e.push(this);}});return e;},_fade:function(){var d=this,e=c(d).children(d.opt.balloon?".validaty-balloon":".validaty-message");if(e.length>1){e.on("mouseenter.validaty",function(){var f=this;other=e.filter(function(){return this!==f;});other.animate({opacity:0.2},{duration:d.opt.fadeSpeed,queue:false});}).on("mouseleave.validaty",function(){e.animate({opacity:1},{duration:d.opt.fadeSpeed,queue:false});});}},_fields:function(){var e=c(this),d=e.is("form")?c(this).find(":input[data-validaty]"):e;return d.not(this.opt.ignore);},_format:function(f,d){f=f||"Message type missing!";var g=f.match(/{[^}]*}/g);if(g){for(var e=0;e<g.length;e++){if(e==d.length){break;}f=f.replace(g[e],d[e]);}}return f;},_highlight:function(d){var e=d.el;if(b.isCheckable(d.el[0])){e=c(this).find('[name="'+d.el.attr("name")+'"]');}e.addClass(d.fail.length?"invalid":"valid");},_message:function(g,e,d){var f=e.message;if(typeof e.message==="object"){if(g.is("input")){f=e.message[g.attr("type")];}else{if(g.is("select")){f=e.message.select;}}}return a._format.call(this,f,d);},_process:function(d,e){var f=this,h=e&&e.type==="submit";c.each(d,function(){var i=a._validate.call(f,this);a._clear.call(f,this);if(i.fail.length>0){if(h){e.preventDefault();}a._display.call(f,i);}a._highlight.call(f,i);});if(f.opt.focus&&h){var g=true;c(f).find(".invalid:visible:"+f.opt.focus).trigger("focus",g);}if(f.opt.fade){a._fade.call(f);}},_setHash:function(d){d.hash="validaty-"+Math.random().toString().substring(2);},_showBalloon:function(e){var d=e.offset().top-e.height();if(this.opt.balloon){e.css({top:d});}e.animate({opacity:1});},_writeBalloon:function(f,d){var e=f.children("ul");c.each(d.fail,function(){c("<li />",{text:this.message}).appendTo(e);});},_validate:function(k){var m=this,l=[],g=b.getParams(k).validations;k=c(k);var o={el:k,pass:[],fail:[]};for(var h=0;h<g.length;h++){var f=g[h].name,e=m.opt.validators[f];if(!e){c.error('Validator "'+f+'" not registered!');}var j=g[h].args,d=e.validate.apply(k,[b,m].concat(j)),n=a._message.call(m,k,e,j);o[d?"pass":"fail"].push({type:f,message:n});}return o;},destroy:function(){return c(this).each(function(){c(this).off(".validaty").removeClass("validaty");});},helper:function(d){return b;},validate:function(){return this.each(function(){a._process.call(this,this.distinct);});},validator:function(d){return c.fn.validaty.defaults.validators[d]||c.error('Validator "'+d+'" not registered!');}},b={contains:function(d,e){return d.indexOf(e)!==-1;},getParams:function(m){var g=c(m).attr("data-validaty"),e={validations:[],actions:[]};if(g){var l=g.split(/\s+/);for(var h=0;h<l.length;h++){var k=c(l[h].split(":")).get().reverse(),d=k.pop(),n=d.startsWith("on");k=c(k).get().reverse();if(!n){for(var f=0;f<k.length;f++){if(isNaN(k[f])){k[f]=k[f].replace("%20"," ");}else{if(d!=="equal"){k[f]=parseInt(k[f]);}}}}e[n?"actions":"validations"].push({name:d,args:k});}}else{return undefined;}return e;},isCheckable:function(d){return/checkbox|radio/i.test(d.type);},isDateISO:function(d){return/^(\d{4})\-(0[1-9]|1[0-2])\-([12]\d|0[1-9]|3[01])$/.test(d);},isDigits:function(d){return/^\d+$/.test(d);},isEmail:function(d){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(d);},isNumber:function(d){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(d);},isUrl:function(d){return/^(https?|s?ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(d);},isUsername:function(d){return/^[a-zA-Z0-9]+(_?[a-zA-Z0-9]+)*$/i.test(d);}};c.fn.validaty=function(d){if(a[d]){return a[d].apply(this,Array.prototype.slice.call(arguments,1));}else{if(typeof d==="object"||!d){return a.init.apply(this,arguments);}else{c.error("Method "+d+" does not exist!");}}};c.fn.validaty.defaults={balloon:true,fade:true,fadeSpeed:200,focus:"first",ignore:":submit, :reset, :image, :disabled",validators:{}};c.validaty={register:function(){c.fn.validaty.defaults.validators[arguments[0]]={message:arguments[1],validate:arguments[2]};return this;}};})(jQuery);
